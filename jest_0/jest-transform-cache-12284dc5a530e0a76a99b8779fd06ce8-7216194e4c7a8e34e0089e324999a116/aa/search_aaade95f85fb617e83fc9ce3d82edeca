'use strict';Object.defineProperty(exports, "__esModule", { value: true });var SEARCH_INPUT_KEY_PRESSED = exports.SEARCH_INPUT_KEY_PRESSED = 'SEARCH_INPUT_KEY_PRESSED';
var searchInputKeyPressed = exports.searchInputKeyPressed = function searchInputKeyPressed(text) {
    return {
        type: SEARCH_INPUT_KEY_PRESSED,
        text: text };

};

var SEARCH_DOCUMENTS = exports.SEARCH_DOCUMENTS = 'SEARCH_DOCUMENTS';
var searchDocuments = exports.searchDocuments = function searchDocuments(text) {
    return {
        type: SEARCH_DOCUMENTS,
        text: text };

};

var RECEIVE_DOCUMENTS = exports.RECEIVE_DOCUMENTS = 'RECEIVE_DOCUMENTS';
var receiveDocuments = function receiveDocuments(json) {
    return {
        type: RECEIVE_DOCUMENTS,
        documents: json.map ? json : [],
        receivedAt: Date.now() };

};

var RECEIVE_DOCUMENTS_ERROR = exports.RECEIVE_DOCUMENTS_ERROR = 'RECEIVE_DOCUMENTS_ERROR';
var receiveDocumentsError = function receiveDocumentsError() {
    return {
        type: RECEIVE_DOCUMENTS_ERROR,
        documents: [],
        receivedAt: Date.now() };

};

var fetchDocuments = exports.fetchDocuments = function fetchDocuments(text) {

    return function (dispatch) {

        dispatch(searchDocuments(text));

        return fetch('/ajax/document/search?q=' + text).
        then(function (response) {return response.json();}).
        then(function (json) {return dispatch(receiveDocuments(json));}).
        catch(function (error) {return dispatch(receiveDocumentsError());});
    };
};

var fetchDocumentsIfNeeded = exports.fetchDocumentsIfNeeded = function fetchDocumentsIfNeeded(text) {

    return function (dispatch, getState) {
        return dispatch(fetchDocuments(text));
    };
};